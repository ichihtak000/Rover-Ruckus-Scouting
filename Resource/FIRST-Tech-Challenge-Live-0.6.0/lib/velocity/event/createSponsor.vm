## Copyright (c) 2018 FIRST, Thomas Barnette, George Marchant, and Trey Woodlief. All rights reserved.
##
## Redistribution and use in source and binary forms, with or without modification,
## are permitted (subject to the limitations in the disclaimer below) provided that
## the following conditions are met:
##
## Redistributions of source code must retain the above copyright notice, this list
## of conditions and the following disclaimer.
##
## Redistributions in binary form must reproduce the above copyright notice, this
## list of conditions and the following disclaimer in the documentation and/or
## other materials provided with the distribution.
##
## Neither the name of FIRST nor the names of its contributors may be used to endorse or
## promote products derived from this software without specific prior written permission.
##
## NO EXPRESS OR IMPLIED LICENSES TO ANY PARTY'S PATENT RIGHTS ARE GRANTED BY THIS
## LICENSE. THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
## "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
## THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
## ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE
## FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
## DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
## SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
## CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
## OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
## OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
##

#parse("/velocity/layout.vm")
#@mainLayout()
<script>
function createSponsor() {
	o = {
			#if($curCode)code: $curCode,#end
			name: $("#sponsorNameInput").val(),
			level: $("#levelSelect").val(),
			logoPath: $("#logoPath").text(),
	};
	#if($curCode)
		$.ajax({
		    url: '.',
		    type: 'PUT',
		    data: o,
		    success: function (data,textStatus, xhr) {
		    	
		    },
		    error: function(xhr, status, error){
		    
		    }
		});
	#else
	$.ajax({
	    url: '.',
	    type: 'POST',
	    data: o,
	    success: function (data,textStatus, xhr) {
	    	window.location.href = '..';
	    },
	    error: function(xhr, status, error){
	    
	    }
	});
	#end
}
function uploadLogo(){
	var files = document.getElementById("logoFile").files;
	var formData = new FormData();
	formData.append("file",files[0], files[0].name);
	
	$.ajax({
       url : 'logo/',
       type : 'POST',
       data : formData,
       processData: false,  // tell jQuery not to process the data
       contentType: false,  // tell jQuery not to set contentType
       success : function(data) {
          // preview the logo using the name we got back
          document.getElementById("previewLogo").src = "/img/sponsors/" + data;
          $("#logoPath").text(data);
       },
       fail : function(xhr, textStatus, error){
		  
		}
	});
}
</script>
<style>
#previewLogo {
	max-width:100%;
}
</style>
	<div class="col-12">
		<a href="/event/$eventCode/dashboard/sponsors/"><< Back to Sponsor List</a>
	</div>
<div class="row">
	<div class="col-md-6 offset-md-3">
		<div class="form-group">
    		<label for="sponsorNameInput">Sponsor Name:</label>
			<input id="sponsorNameInput" type="text" name="sponsorName" class="form-control" placeholder="Sponsor Name" value="$!curName"/>
		</div>
		<div class="form-group">
			<label for="levelSelect">Level:</label>
			<select class="custom-select" name="levelSelect" id="levelSelect">
			#foreach($level in $levelDisplayStrings)
				<option value="$foreach.index" #if($curLevel.getDisplayString() == $level)selected#end>$level</option>
			#end
			</select>
		</div>
		<div class="form-group">
			<label for="logoFile">Logo:</label>
			<br>
			<input id="logoFile" type="file" name="file"/>
			<button id="uploadLogo" onclick="uploadLogo()">Import Logo</button>
		</div>
		<div>
			<small id="logoPath">$!curLogoPath</small>
			<img src="$!curLogoImagePath" id="previewLogo"></img>
		</div>
		<input type="button" onclick="createSponsor()" name="submit" class="btn btn-primary" #if($curCode) value="Save Sponsor" #else value="Create Sponsor"#end />
		<input type="hidden" name="client_name" value="FormClient">
	</div>
</div>
#end